<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
        <meta http-equiv="X-UA-Compatible" content="IE=8"/>
        <script language="JavaScript" charset="ISO-8859-1" type="text/javascript" src="js/jsMain.js"></script>
        <link type="text/css" rel="stylesheet" href="../css/main.css"/>
                <link type="text/css" rel="stylesheet" href="../css/notificacionMarca.css?v=0004"/>
        <link rel="shortcut icon" href="/imagenes/favicon.ico"/>
        <title>CONFIR - Generación de Documentos</title>
        <script type="text/javascript">
            //<![CDATA[
                function fn_verificarEstado(){
                    document.getElementById('frmConversion:btnVerificarFirma').click();
                }
                
                function fn_detener() {
                    clearTimeout(myVar);
                }
        
                function fn_seleccionarTablaResultados(nuIdAplicacion) {
                    if(nuIdAplicacion == 1){
                        document.getElementById('frmConversion:bt_conversion_res_filtro_buscar').click();}
                    if(nuIdAplicacion == 2){
                        document.getElementById('frmConversion:bt_conversion_cer_filtro_buscar').click();}
                    if(nuIdAplicacion == 3){
                        document.getElementById('frmConversion:bt_conversion_not_filtro_buscar').click();}
                    if(nuIdAplicacion == 4){
                        document.getElementById('frmConversion:bt_conversion_res_filtro_buscar').click();}
                }
        
                function fn_iniciarFirma() {
                    document.getElementById('frmConversion:btnIniciar').click();
                }
                  
                function seleccionarTodo(source) {
                    checkboxes = document.getElementsByTagName('input');
                    for (i = 0;i < checkboxes.length;i++){
                        if (checkboxes[i].type == "checkbox" && checkboxes[i].id != "frmGeneracion:dtb_conversion_res_resultados:cbxSelTodosDoc"){
                            checkboxes[i].checked = source.checked;}
                        if (checkboxes[i].type == "checkbox" && checkboxes[i].id != "frmGeneracion:dtb_conversion_cer_resultados:cbxSelTodosDoc"){
                            checkboxes[i].checked = source.checked;}
                        if (checkboxes[i].type == "checkbox" && checkboxes[i].id != "frmGeneracion:dtb_conversion_not_resultados:cbxSelTodosDoc"){
                            checkboxes[i].checked = source.checked;}
                    }
                }
                
                function fn_seleccionarTablaConversion(nuIdAplicacion) {
                    alert(nuIdAplicacion);
                    if(nuIdAplicacion == 1){
                        document.getElementById('frmConversion:dtb_conversion_res_resultados');}
                    if(nuIdAplicacion == 2){
                        document.getElementById('frmConversion:dtb_conversion_cer_resultados');}
                    if(nuIdAplicacion == 3){
                        document.getElementById('frmConversion:dtb_conversion_not_resultados');}
                    if(nuIdAplicacion == 4){
                        document.getElementById('frmConversion:dtb_conversion_res_resultados');}
                }
                  
                function checkAllCheckboxesInTable(state,nuIdAplicacion){
                    
                    var tableElement =null;
                    //var inputs = tableElement.getElementsByTagName('input');
                    if(nuIdAplicacion == 1){
                        tableElement = document.getElementById('frmConversion:dtb_conversion_res_resultados');}
                    if(nuIdAplicacion == 2){
                        tableElement = document.getElementById('frmConversion:dtb_conversion_cer_resultados');}
                    if(nuIdAplicacion == 3){
                        tableElement = document.getElementById('frmConversion:dtb_conversion_not_resultados');}
                    if(nuIdAplicacion == 4){
                        tableElement = document.getElementById('frmConversion:dtb_conversion_res_resultados');}
                        
                    var inputs = tableElement.getElementsByTagName('input');
                    
                    for (var i = 0; i <= inputs.length; i++){
                        var input = inputs[i];
                        if (input != undefined) {
                            if( input.getAttribute('type') == 'checkbox' && input.className == "cbInd"){
                                if (state.checked){
                                    console.log('objeto true: '+input);
                                    input.setAttribute('checked', state.checked);
                                }else{
                                    console.log('objeto false: '+input);
                                    input.setAttribute('checked', false);
                                    input.removeAttribute('checked');
                                }
                            }
                        }
                    }
                }
                
            //]]>
        </script>
    </head>
    <body>
        <rich:panel>
            <rich:messages warnClass="alert alert-warning" infoClass="alert alert-info" errorClass="alert alert-danger" />
            <h:outputText id="ot_general_cer_titulo" value="#{msgs['ot.general.cer.titulo']}"/>
            <br/>
            <br/>
            <rich:tabPanel switchType="client">
            
                <!-- TAB GENERACIÓN -->
                <rich:tab id="lb_generacion_tab" label="#{msgs['lb.generacion.tab']}" rendered="true">
                    <rich:panel>
                        <f:facet name="header">
                            <h:outputText id="ot_generacion_tab" value="#{msgs['ot.generacion.tab']}"/>
                        </f:facet>
                        
                        <a4j:form id="frmGeneracion" ajaxsubmit="true" >
                            <!-- generacion filtros -->
                            <h:panelGrid id="pgGeneracion_filtros">
                                <h:outputText id="ot_generacion_cer_explicacionFiltro" value="#{msgs['ot.generacion.cer.explicacionFiltro']}"/>
                                <h:panelGrid id="pgGeneracion_filtro_cer" columns="5" cellpadding="5">
                                    
                                    <h:outputText id="ot_generacion_cer_filtro_fechaInicio" value="#{msgs['ot.generacion.cer.filtro.fechaInicio']}"/>
                                    <rich:calendar id="cl_generacion_cer_filtro_fechaInicio" value="#{clsDocumentacionSrv.objFiltroBean.dtFechaInicio}"
                                                   locale="en/ES" datePattern="dd-MM-yyyy" cellWidth="12px" cellHeight="22px" inputStyle="width:65px">
                                    </rich:calendar>
                                                   
                                    <h:outputText id="ot_generacion_cer_filtro_nroExpediente" value="#{msgs['ot.generacion.cer.filtro.nroExpediente']}"/>
                                    <h:inputText id="it_generacion_cer_filtro_nroExpediente" value="#{clsDocumentacionSrv.objFiltroBean.vcNroExpediente}"/>
                                                 
                                    <h:outputText value=""/>
                                    
                                    <h:outputText id="ot_generacion_cer_filtro_fechaFin" value="#{msgs['ot.generacion.cer.filtro.fechaFin']}"/>
                                    <rich:calendar id="cl_generacion_cer_filtro_fechaFin" value="#{clsDocumentacionSrv.objFiltroBean.dtFechaFin}"
                                                   locale="en/ES" datePattern="dd-MM-yyyy" cellWidth="12px" cellHeight="22px" inputStyle="width:65px">
                                    </rich:calendar>
                                    
                                    <h:outputText id="ot_generacion_cer_filtro_nroResolucion" value="#{msgs['ot.generacion.cer.filtro.nroResolucion']}"/>
                                    <h:inputText id="it_generacion_cer_filtro_nroResolucion" value="#{clsDocumentacionSrv.objFiltroBean.vcNroResolucion}"/>
                                                 
                                    <h:outputText value=""/>
                                    
                                    <h:outputText id="ot_generacion_cer_filtro_tipoSolicitud" value="#{msgs['ot.generacion.cer.filtro.tipoSolicitud']}"/>
                                    <h:selectOneMenu id="cb_generacion_cer_filtro_tipoSolicitud" required="true" width="200" value="#{clsDocumentacionSrv.objFiltroBean.vcIdTipoSolicitud}">
                                        <f:selectItems value="#{clsDocumentacionSrv.objFiltroBean.lstTipoSolicitudes}"/>                                                   
                                    </h:selectOneMenu>
                                    
                                    <h:outputText id="ot_generacion_cer_filtro_nroCertificado" value="#{msgs['ot.generacion.cer.filtro.nroCertificado']}"/>
                                    <h:inputText id="it_generacion_cer_filtro_nroCertificado" value="#{clsDocumentacionSrv.objFiltroBean.vcNroCertificado}"/>
                                                 
                                    <h:outputText value=""/>
                                    
                                    <h:outputText id="ot_generacion_cer_filtro_coordinador" value="#{msgs['ot.generacion.cer.filtro.coordinador']}"/>
                                    <h:selectOneMenu id="cb_generacion_cer_filtro_coordinador" required="true" width="200" value="#{clsDocumentacionSrv.objFiltroBean.vcUsuarioSeg}">
                                        <f:selectItems value="#{clsDocumentacionSrv.objFiltroBean.lstCoordinadores}"/>
                                    </h:selectOneMenu>
                                    
                                    <h:outputText id="ot_generacion_cer_filtro_sentidoResolucion" value="#{msgs['ot.generacion.cer.filtro.sentidoResolucion']}"/>
                                    <h:selectOneMenu id="cb_generacion_cer_filtro_sentidoResolucion" required="true" width="200" value="#{clsDocumentacionSrv.objFiltroBean.vcSentidoResolucion}">
                                        <f:selectItems value="#{clsDocumentacionSrv.objFiltroBean.lstSentidoResoluciones}"/>
                                    </h:selectOneMenu>
                                    
                                    
                                    <a4j:commandButton id="bt_generacion_cer_filtro_buscar" 
                                                       value="#{msgs['bt.generacion.cer.filtro.buscar']}">
                                        
                                        <a4j:support event="onclick" action="#{clsDocumentacionSrv.doGeneracionListarExpedientes(1)}"
                                                     reRender="dtb_generacion_cer_resultados,bt_generacion_cer_accion_exportarExcel_superior,bt_generacion_cer_accion_exportarExcel_inferior"
                                                     onsubmit="#{rich:component('panProcesando')}.show();"
                                                     oncomplete="#{rich:component('panProcesando')}.hide();">
                                        </a4j:support>
                                        
                                    </a4j:commandButton>
                                    
                                </h:panelGrid>                               
                            </h:panelGrid>
                            <hr/>
                            <!-- generacion acciones superior -->
                            <h:panelGrid id="pgGeneracion_acciones_cer_superior" columns="5">                            
                                
                                <a4j:commandButton id="bt_generacion_cer_accion_generarWord_superior" 
                                                   value="#{msgs['bt.generacion.cer.accion.generarWord']}" 
                                                   rendered="true">
                                                   
                                    <a4j:support event="onclick" action="#{clsDocumentacionSrv.doGenerarWordMasivo}"
                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                 oncomplete="#{rich:component('panProcesando')}.hide();"
                                                 reRender="dtb_generacion_cer_resultados">
                                    </a4j:support>  
                                    
                                </a4j:commandButton>
                           
                                <!--Exporta exel-->
                                <a4j:commandButton id="bt_generacion_cer_accion_exportarExcel_superior" 
                                                   value="#{msgs['bt.generacion.cer.accion.exportarExcel']}"
                                                   style="display:#{clsDocumentacionSrv.vcMuestraExelRegistro}">
                                        <a4j:support event="onclick"
                                                    onsubmit="#{rich:component('panProcesando')}.show();"
                                                    onclick = "javaScript:document.getElementById('frmGeneracion:cml_generacion_exportarExcel').click();"
                                                    oncomplete="#{rich:component('panProcesando')}.hide();"
                                                    >
                                        </a4j:support>
                                </a4j:commandButton> 
                                <!--Exporta exel-->
                                
                                <!--Componente que se encarga de actualizar automaticamente la tabla-->
                                <a4j:commandButton value="Refrescar Lista de Expedientes"
                                                   reRender="dtb_generacion_cer_resultados" styleClass="btn-success">
                                    <a4j:support event="onclick"
                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                 oncomplete="#{rich:component('panProcesando')}.hide();">
                                    </a4j:support>
                                </a4j:commandButton>
                                
                            </h:panelGrid>
                            <!-- generacion resultados -->
                            <h:panelGrid id="pgGeneracion_resultados">
                                <rich:dataTable id="dtb_generacion_cer_resultados" value="#{clsDocumentacionSrv.lstExpedientesBean}"
                                                var="result" width="100%" rows="25" rowKeyVar="row"
                                                onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
                                                onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'">
                                                
                                    <f:facet name="header">
                                        <h:outputText id="ot_generacion_cer_resultado_totalRegistros" value="#{clsDocumentacionSrv.vcNroRegistros}"/>
                                    </f:facet>
                                    <!--col_1-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_nro" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.nro']}"/>
                                        </f:facet>
                                        <h:outputText value="#{row + 1}"/>
                                    </rich:column>
                                    <!--col_2-->
                                    <rich:column style="text-align:center;">
                                        <f:facet name="header">
                                            <h:panelGroup>
                                                <h:outputText id="ot_generacion_cer_resultado_seleccionar" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.seleccionar']}"/>
                                                <br/>
                                                <h:outputText id="ot_generacion_cer_resultado_todos" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.todos']}"/>
                                                <br/>
                                                <h:selectBooleanCheckbox id="cbxSelTodos">
                                                    <a4j:support event="onchange" oncomplete="seleccionarTodo(this);"/>
                                                </h:selectBooleanCheckbox>
                                            </h:panelGroup>
                                        </f:facet>
                                        <h:selectBooleanCheckbox value="#{result.blIndSeleccion}"/>
                                    </rich:column>
                                    <!--col_3-->
                                    <rich:column style="text-align:center;">
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_expediente" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.expediente']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcNroExpediente}"/>
                                    </rich:column>
                                    <!--col_4-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_anio" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.anio']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.nuAnioExpediente}"/>
                                    </rich:column>
                                    <!--col_5-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_fechaPresentacion" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.fechaPresentacion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.dtFechaPresentacion}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </rich:column>
                                    <!--col_6-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_tipoPresentacion" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.tipoPresentacion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcTipoPresentacion}"/>
                                    </rich:column>
                                    <!--col_7-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_tipoSolicitud" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.tipoSolicitud']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcInicial}"/>
                                    </rich:column>
                                    <!--col_8-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_denominacion" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.denominacion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcDenominacion}"/>
                                    </rich:column>
                                    <!--col_9-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_clases" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.clases']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcClasesNiza}"/>
                                    </rich:column>
                                    <!--col_10-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_tipoResolucion" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.tipoResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcTipoResolucion}"/>
                                    </rich:column>
                                    <!--col_11-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_sentidoResolucion" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.sentidoResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcSentidoResolucion}"/>
                                    </rich:column>
                                    <!--col_12-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_nroResolucion" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.nroResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcNroResolucion}"/>
                                    </rich:column>
                                    <!--col_13-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_fechaResolucion" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.fechaResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.dtFechaResolucion}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </rich:column>
                                    <!--col_14-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_fechaVencimiento" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.fechaVencimiento']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.dtFechaVencimiento}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </rich:column>
                                    <!--col_15-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_nroCertificado" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.nroCertificado']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcNroCertificado}"/>
                                    </rich:column>
                                    <!--col_16-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_tomo" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.tomo']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcTomo}"/>
                                    </rich:column>
                                    <!--col_17-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_generacion_cer_resultado_folio" style="font-size:9px" value="#{msgs['ot.generacion.cer.resultado.folio']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcFolio}"/>
                                    </rich:column>
                                    
                                    <f:facet name="footer">
                                        <rich:datascroller id="ds_generacion_cer_resultados" for="dtb_generacion_cer_resultados" maxPages="20" width="100%" rendered="true"/>
                                    </f:facet>
                                
                                </rich:dataTable>
                                <!-- generacion resultados notificacion -->
                            
                            </h:panelGrid>
                            <!-- generacion acciones inferior -->
                            <h:panelGrid id="pgGeneracion_acciones_cer_inferior" columns="2">                            
                            
                                <a4j:commandButton id="bt_generacion_cer_accion_generarWord_inferior" 
                                                   value="#{msgs['bt.generacion.cer.accion.generarWord']}" 
                                                   rendered="true">
                                                   
                                    <a4j:support event="onclick" action="#{clsDocumentacionSrv.doGenerarWordMasivo}"
                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                 oncomplete="#{rich:component('panProcesando')}.hide();"
                                                 reRender="dtb_generacion_cer_resultados">
                                    </a4j:support>  
                                    
                                </a4j:commandButton>
                               
                                
                                <a4j:commandButton id="bt_generacion_cer_accion_exportarExcel_inferior" 
                                                   value="#{msgs['bt.generacion.cer.accion.exportarExcel']}"
                                                   style="display:#{clsDocumentacionSrv.vcMuestraExelRegistro}">
                                        <a4j:support event="onclick"
                                                    onsubmit="#{rich:component('panProcesando')}.show();"
                                                    onclick = "javaScript:document.getElementById('frmGeneracion:cml_generacion_exportarExcel').click();"
                                                    oncomplete="#{rich:component('panProcesando')}.hide();"
                                                    >
                                        </a4j:support>
                                </a4j:commandButton>
                                
                            
                            </h:panelGrid>
                            <hr/>
                            <!-- generacion acciones general -->
                            <h:panelGrid id="pgGeneracion_acciones_general">
                            
                                <h:commandLink id = "cml_generacion_exportarExcel" action="#{clsDocumentacionSrv.doExportarExcel(1)}"
                                               style="margin-right:20px;display:none">
                                        <h:graphicImage url="/imagenes/icoExcel.PNG" style="margin-right:20px;"/>
                                </h:commandLink>
                            
                            </h:panelGrid>
                        </a4j:form>
                        
                    </rich:panel>
                
                </rich:tab>
                <!-- TAB CONVERSIÓN -->
                <rich:tab id="lb_gen_tabConversion" label="#{msgs['lb.gen.tabConversion']}" rendered="true">
                    <rich:panel>
                        <f:facet name="header">
                            <h:outputText id="ot_gen_tabConversion" value="#{msgs['ot.gen.tabConversion']}"/>
                        </f:facet>
                        
                        <a4j:form id="frmConversion" ajaxsubmit="true">
                            <!-- conversion filtros -->
                            <h:panelGrid id="pgConversion_filtros">
                            
                                <h:outputText id="ot_conversion_gen_explicacionFiltro" value="#{msgs['ot.conversion.gen.explicacionFiltro']}"/>
                                <h:panelGrid id="pgConversion_filtro_cer" columns="5" cellpadding="3">
                                    
                                    <h:outputText id="ot_conversion_cer_filtro_fechaInicio" value="#{msgs['ot.conversion.cer.filtro.fechaInicio']}"/>
                                    <rich:calendar id="cl_conversion_cer_filtro_fechaInicio" value="#{clsDocumentacionSrv.objFiltroBean.dtFechaInicio}"
                                                   locale="en/ES" datePattern="dd-MM-yyyy"
                                                   cellWidth="12px" cellHeight="22px" inputStyle="width:65px"></rich:calendar>
                                    
                                    <h:outputText id="ot_conversion_cer_filtro_nroExpediente" value="#{msgs['ot.conversion.cer.filtro.nroExpediente']}"/>
                                    <h:inputText id="it_conversion_cer_filtro_nroExpediente" value="#{clsDocumentacionSrv.objFiltroBean.vcNroExpediente}"/>
                                                 
                                    <h:outputText value=""/>
                                    
                                    <h:outputText id="ot_conversion_cer_filtro_fechaFin" value="#{msgs['ot.conversion.cer.filtro.fechaFin']}"/>
                                    <rich:calendar id="cl_conversion_cer_filtro_fechaFin" value="#{clsDocumentacionSrv.objFiltroBean.dtFechaFin}"
                                                   locale="en/ES" datePattern="dd-MM-yyyy"
                                                   cellWidth="12px" cellHeight="22px" inputStyle="width:65px"></rich:calendar>
                                                   
                                    <h:outputText id="ot_conversion_cer_filtro_nroResolucion" value="#{msgs['ot.conversion.cer.filtro.nroResolucion']}"/>
                                    <h:inputText id="it_conversion_cer_filtro_nroResolucion" value="#{clsDocumentacionSrv.objFiltroBean.vcNroResolucion}"/>
                                    
                                    <h:outputText value=""/>
                                    
                                    <h:outputText id="ot_conversion_cer_filtro_tipoSolicitud" value="#{msgs['ot.conversion.cer.filtro.tipoSolicitud']}"/>
                                    <h:selectOneMenu id="cb_conversion_cer_filtro_tipoSolicitud" required="true" width="200" value="#{clsDocumentacionSrv.objFiltroBean.vcIdTipoSolicitud}">
                                        <f:selectItems value="#{clsDocumentacionSrv.objFiltroBean.lstTipoSolicitudes}"/>
                                    </h:selectOneMenu>
                                    
                                    <h:outputText id="ot_conversion_cer_filtro_nroCertificado" value="#{msgs['ot.conversion.cer.filtro.nroCertificado']}"/>
                                    <h:inputText id="it_conversion_cer_filtro_nroCertificado" value="#{clsDocumentacionSrv.objFiltroBean.vcNroCertificado}"/>
                                                                                     
                                    <a4j:commandButton id="bt_conversion_cer_filtro_buscar" 
                                                       value="#{msgs['bt.conversion.cer.filtro.buscar']}">
                                    
                                        <a4j:support event="onclick"
                                                     action="#{clsDocumentacionSrv.doConversionListarDocumentos(2)}"
                                                     reRender="dtb_conversion_cer_resultados,bt_conversion_cer_accion_exportarExcel_superior,bt_conversion_cer_accion_exportarExcel_inferior"
                                                     onsubmit="#{rich:component('panProcesando')}.show();"
                                                     oncomplete="#{rich:component('panProcesando')}.hide();">
                                        </a4j:support>
                                        
                                    </a4j:commandButton>
                            
                                </h:panelGrid>
                            </h:panelGrid>
                            <hr/>
                            <!-- conversion acciones superior -->
                            <h:panelGrid id="pgConversion_acciones_cer_superior" columns="6">
                                
                                <a4j:commandButton id="bt_conversion_cer_accion_cargarWord_superior" 
                                                   value="#{msgs['bt.conversion.cer.accion.cargarWord']}"
                                                   rendered="true">
                                                   
                                    <a4j:support event="onclick"
                                                 onsubmit="#{rich:component('panCargaDocumentos')}.show();">
                                    </a4j:support>
                                    
                                </a4j:commandButton>
                                
                                <a4j:commandButton id="bt_conversion_cer_accion_convertirWord_superior" 
                                                   value="#{msgs['bt.conversion.cer.accion.convertirWord']}"
                                                   rendered="true">
                                                   
                                    <a4j:support event="onclick" 
                                                 action="#{clsDocumentacionSrv.doConvertirWordPDFMasivo}"
                                                 reRender="dtb_conversion_cer_resultados"
                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                 oncomplete="#{rich:component('panProcesando')}.hide();">
                                    </a4j:support>                 
                                    
                                </a4j:commandButton>
                                
                                <a4j:commandButton id="bt_conversion_cer_accion_firmarDigitalmente_superior" 
                                                   value="#{msgs['bt.conversion.cer.accion.firmarDigitalmente']}"
                                                   rendered="true"
                                                   action="#{clsDocumentacionSrv.doPDFFirma}">
                                                   
                                    <a4j:support event="onclick" 
                                                 oncomplete="document.getElementById('link').click();">
                                    </a4j:support>
                                                                            
                                </a4j:commandButton>
                                                                                       
                                <a4j:commandButton id="bt_conversion_cer_accion_eliminarDoc_superior" 
                                                   value="#{msgs['bt.conversion.cer.accion.eliminarDoc']}"
                                                   rendered="true">
                                                   
                                    <a4j:support event="onclick" 
                                                 action="#{clsDocumentacionSrv.doEliminarDocs}"
                                                 reRender="dtb_conversion_cer_resultados"
                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                 oncomplete="#{rich:component('panProcesando')}.hide();">
                                    </a4j:support>
                                    
                                </a4j:commandButton>

                                <!--Exporta exel-->
                                <a4j:commandButton id="bt_conversion_cer_accion_exportarExcel_superior" 
                                                   value="#{msgs['bt.generacion.cer.accion.exportarExcel']}"
                                                   style="display:#{clsDocumentacionSrv.vcMuestraExelConversion}">
                                        <a4j:support event="onclick"
                                                    onsubmit="#{rich:component('panProcesando')}.show();"
                                                    onclick = "javaScript:document.getElementById('frmConversion:cml_conversion_exportarExcel').click();"
                                                    oncomplete="#{rich:component('panProcesando')}.hide();"
                                                    >
                                        </a4j:support>
                                </a4j:commandButton> 
                                
                                <!--Exporta exel--> 
                                
                                
                                    
                            </h:panelGrid>
                            <!-- conversion resultados -->
                            <h:panelGrid id="pgConversion_resultados">
                                <rich:dataTable id="dtb_conversion_cer_resultados"
                                            value="#{clsDocumentacionSrv.lstDocumentosProcesadosBean}" var="result"
                                            width="100%" rows="50" rowKeyVar="row"
                                            onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
                                            onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'">
                                            
                                    <f:facet name="header">
                                        <h:outputText id="ot_conversion_cer_resultado_totalRegistros" value="#{clsDocumentacionSrv.vcNroConversion}"/>
                                    </f:facet>
                                    <!--col_1-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_nro" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.nro']}"/>
                                        </f:facet>
                                        <h:outputText value="#{row + 1}"/>
                                    </rich:column>
                                    <!--col_2-->
                                    <rich:column style="text-align:center;">
                                    
                                        <f:facet name="header">
                                        
                                            <h:panelGroup>
                                            
                                                <h:outputText id="ot_conversion_cer_resultado_seleccionar" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.seleccionar']}"/>
                                                
                                                <br/>
                                                
                                                <h:outputText id="ot_conversion_cer_resultado_todos" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.todos']}"/>
                                                
                                                <br/>
                                                
                                                <h:selectBooleanCheckbox id="cbxSelTodosDoc"
                                                                         onclick="checkAllCheckboxesInTable(this,#{clsDocumentacionSrv.objFiltroBean.nuIDTipoAplicacion});"
                                                                         value="#{clsDocumentacionSrv.blCheckTable}">
                                                    
                                                    <a4j:support event="onchange"
                                                                 action="#{clsDocumentacionSrv.cambioCheck}"
                                                                 reRender="dtb_conversion_cer_resultados"/>
                                                                 
                                                </h:selectBooleanCheckbox>
                                                
                                            </h:panelGroup>
                                            
                                        </f:facet>
                                        
                                        <h:selectBooleanCheckbox class="cbInd" value="#{result.blIndSeleccion}"/>
                                        
                                    </rich:column>
                                    <!--col_3-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_expediente" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.expediente']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcNroExpediente}"/>
                                    </rich:column>
                                    <!--col_4-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_anio" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.anio']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.nuAnioExpediente}"/>
                                    </rich:column>
                                    <!--col_5-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_tipoResolucion" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.tipoResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcTipoResolucion}"/>
                                    </rich:column>
                                    <!--col_6-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_sentidoResolucion" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.sentidoResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcSentidoResolucion}"/>
                                    </rich:column>
                                    <!--col_7-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_nroResolucion" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.nroResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcNroResolucion}"/>
                                    </rich:column>
                                    <!--col_8-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_fechaResolucion" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.fechaResolucion']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcFechaResolucionFormatoLargo}"/>
                                    </rich:column>
                                    <!--col_9-->
                                    <rich:column>
                                        <f:facet name="header">
                                            <h:outputText id="ot_conversion_cer_resultado_nroCertificado" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.nroCertificado']}"/>
                                        </f:facet>
                                        <h:outputText value="#{result.vcNroCertificado}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </rich:column>
                                    <!--col_10-->
                                    <rich:column style="text-align:center;">
                                    
                                        <f:facet name="header">
                                        
                                            <h:panelGroup>
                                            
                                                <h:outputText id="ot_conversion_cer_resultado_editar" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.editar']}"/>
                                                
                                                <br/>
                                                
                                                <a4j:commandButton id="bt_conversion_cer_resultado_dwldEditar" 
                                                                   image="/imagenes/dwld.png">
                                                                   
                                                    <a4j:support event="onclick"
                                                                 action="#{clsDocumentacionSrv.doGenerarDoc(1)}"
                                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                                 oncomplete="document.getElementById('frmConversion:dtb_conversion_cer_resultados:cml_conversion_cer_resultado_dwldWord').click(); #{rich:component('panProcesando')}.hide();">
                                                    </a4j:support>
                                                    
                                                </a4j:commandButton>
                                                
                                                <h:commandLink id="cml_conversion_cer_resultado_dwldWord"
                                                               action="#{clsDocumentacionSrv.doDescargarDoc}"
                                                               style="margin-right:20px;display:none;">
                                                    <h:graphicImage url="/imagenes/dwld.png" style="margin-right:20px;"/>
                                                </h:commandLink>
                                                
                                            </h:panelGroup>
                                            
                                        </f:facet>
                                        
                                        <h:commandLink disabled="#{result.nuIndWord == 3?'true':'false'}"
                                                       action="#{clsDocumentacionSrv.doExportarDoc(result.nuIdProcesoDocumento,1,result.vcNombreExterno)}">
                                            <h:graphicImage url="#{result.nuIndWord == 1?'/imagenes/btn_word.png': (result.nuIndWord == 2?'/imagenes/btn_word_m.png':(result.nuIndWord == 3?'/imagenes/btn_word_disable.png':''))}"/>
                                        </h:commandLink>
                                        
                                    </rich:column>
                                    <!--col_11 -->
                                    <rich:column style="text-align:center;">
                                    
                                        <f:facet name="header">
                                        
                                            <h:panelGroup>
                                            
                                                <h:outputText id="ot_conversion_cer_resultado_imprimir" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.imprimir']}"/>
                                                
                                                <br/>
                                                
                                                <a4j:commandButton id="bt_conversion_cer_resultado_dwldImprimir" 
                                                                   image="/imagenes/dwld.png">
                                                                   
                                                    <a4j:support event="onclick"
                                                                 action="#{clsDocumentacionSrv.doGenerarDoc(3)}"
                                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                                 oncomplete="document.getElementById('frmConversion:dtb_conversion_cer_resultados:cml_conversion_cer_resultado_dwldPDF').click(); #{rich:component('panProcesando')}.hide();">
                                                    </a4j:support>
                                                    
                                                </a4j:commandButton>
                                                
                                                <h:commandLink id="cml_conversion_cer_resultado_dwldPDF"
                                                               action="#{clsDocumentacionSrv.doDescargarDoc}"
                                                               style="margin-right:20px;display:none;">
                                                    <h:graphicImage url="/imagenes/dwld.png" style="margin-right:20px;"/>
                                                </h:commandLink>
                                                
                                            </h:panelGroup>
                                            
                                        </f:facet>
                                        
                                        <h:commandLink action="#{clsDocumentacionSrv.doExportarDoc(result.nuIdProcesoDocumento,3,result.vcNombreExterno)}">
                                            <h:graphicImage url="#{result.nuIndPDFsm == 1?'/imagenes/btn_pdf.png':''}"/>
                                        </h:commandLink>
                                        
                                    </rich:column>
                                    <!--col_12 -->
                                    <rich:column style="text-align:center;">
                                    
                                        <f:facet name="header">
                                        
                                            <h:panelGroup>
                                            
                                                <h:outputText id="ot_conversion_cer_resultado_firmar" style="font-size:9px" value="#{msgs['ot.conversion.cer.resultado.firmar']}"/>
                                                
                                                <br/>
                                                
                                                <a4j:commandButton id="bt_conversion_cer_resultado_dwldFirmar" 
                                                                   image="/imagenes/dwld.png">
                                                                   
                                                    <a4j:support event="onclick"
                                                                 action="#{clsDocumentacionSrv.doGenerarDoc(2)}"
                                                                 onsubmit="#{rich:component('panProcesando')}.show();"
                                                                 oncomplete="document.getElementById('frmConversion:dtb_conversion_cer_resultados:cml_conversion_cer_resultado_dwldPDFDig').click(); #{rich:component('panProcesando')}.hide();">
                                                    </a4j:support>
                                                    
                                                </a4j:commandButton>
                                                
                                                <h:commandLink id="cml_conversion_cer_resultado_dwldPDFDig"
                                                               action="#{clsDocumentacionSrv.doDescargarDoc}"
                                                               style="margin-right:20px;display:none;">
                                                    <h:graphicImage url="/imagenes/dwld.png" style="margin-right:20px;"/>
                                                </h:commandLink>
                                                
                                            </h:panelGroup>
                                            
                                        </f:facet>
                                        
                                        <h:commandLink action="#{clsDocumentacionSrv.doExportarDoc(result.nuIdProcesoDocumento,2,result.vcNombreExterno)}">
                                            <h:graphicImage url="#{result.nuIndPDF == 1?'/imagenes/btn_pdf.png':''}"/>
                                        </h:commandLink>
                                        
                                    </rich:column>
                                    
                                    <f:facet name="footer">
                                        <rich:datascroller id="ds_conversion_cer_resultados" for="dtb_conversion_cer_resultados" maxPages="20" width="100%" rendered="true"/>
                                    </f:facet>
                                    
                                </rich:dataTable>
                                <!-- conversion resultados notificacion -->
                            
                            </h:panelGrid>
                            <!-- conversion acciones inferior -->
                            <h:panelGrid id="pgConversion_acciones_cer_inferior" columns="5">
                                
                                    <a4j:commandButton id="bt_conversion_cer_accion_cargarWord_inferior" 
                                                       value="#{msgs['bt.conversion.cer.accion.cargarWord']}"
                                                       rendered="true">
                                                       
                                        <a4j:support event="onclick"
                                                     onsubmit="#{rich:component('panCargaDocumentos')}.show();">
                                        </a4j:support>
                                        
                                    </a4j:commandButton>
                                    
                                    <a4j:commandButton id="bt_conversion_cer_accion_convertirWord_inferior" 
                                                       value="#{msgs['bt.conversion.cer.accion.convertirWord']}"
                                                       rendered="true">
                                                       
                                        <a4j:support event="onclick" 
                                                     action="#{clsDocumentacionSrv.doConvertirWordPDFMasivo}"
                                                     reRender="dtb_conversion_cer_resultados"
                                                     onsubmit="#{rich:component('panProcesando')}.show();"
                                                     oncomplete="#{rich:component('panProcesando')}.hide();">
                                        </a4j:support>                 
                                        
                                    </a4j:commandButton>
                                    
                                    <a4j:commandButton id="bt_conversion_cer_accion_firmarDigitalmente_inferior" 
                                                       value="#{msgs['bt.conversion.cer.accion.firmarDigitalmente']}"
                                                       rendered="true"
                                                       action="#{clsDocumentacionSrv.doPDFFirma}">
                                                       
                                        <a4j:support event="onclick" 
                                                     oncomplete="document.getElementById('link').click();">
                                        </a4j:support>
                                                                                
                                    </a4j:commandButton>
                                                                                           
                                    <a4j:commandButton id="bt_conversion_cer_accion_eliminarDoc_inferior" 
                                                       value="#{msgs['bt.conversion.cer.accion.eliminarDoc']}"
                                                       rendered="true">
                                                       
                                        <a4j:support event="onclick" 
                                                     action="#{clsDocumentacionSrv.doEliminarDocs}"
                                                     reRender="dtb_conversion_cer_resultados"
                                                     onsubmit="#{rich:component('panProcesando')}.show();"
                                                     oncomplete="#{rich:component('panProcesando')}.hide();">
                                        </a4j:support>
                                        
                                    </a4j:commandButton>
                                    
                                    <a4j:commandButton id="bt_conversion_cer_accion_exportarExcel_inferior" 
                                                   value="#{msgs['bt.generacion.cer.accion.exportarExcel']}"
                                                   style="display:#{clsDocumentacionSrv.vcMuestraExelConversion}">
                                        <a4j:support event="onclick"
                                                    onsubmit="#{rich:component('panProcesando')}.show();"
                                                    onclick = "javaScript:document.getElementById('frmConversion:cml_conversion_exportarExcel').click();"
                                                    oncomplete="#{rich:component('panProcesando')}.hide();"
                                                    >
                                        </a4j:support>
                                    </a4j:commandButton> 
                                    
                                </h:panelGrid>
                            <hr/>
                            <!-- conversion acciones general -->
                            <h:panelGrid id="pgConversion_acciones_general">
                                
                                    <a4j:commandButton id="btnIniciar" 
                                                       style="display:none;" 
                                                       value="Iniciar"
                                                       onclick="myVar = setInterval(fn_verificarEstado, 5000);javaScript:Richfaces.showModalPanel('panProcesando');">
                                                       
                                    </a4j:commandButton>
                                    
                                    <a4j:commandButton id="btnDetener" 
                                                       style="display:none;"
                                                       value="Detener"
                                                       onclick="clearTimeout(myVar);
                                                                javaScript:Richfaces.hideModalPanel('panProcesando');
                                                                alert('Se concluyó el proceso de firma.');
                                                                fn_seleccionarTablaResultados(#{clsDocumentacionSrv.objFiltroBean.nuIDTipoAplicacion});
                                                                ">
                                    </a4j:commandButton>
                                   
                                    <a4j:commandButton id="btnVerificarFirma"
                                                       style="display:none;"
                                                       value="Verificar Ahora!"
                                                       action="#{clsDocumentacionSrv.objFirmaDigital.doVerificarProcesoFirma(clsDocumentacionSrv.objFiltroBean)}">
                                                       
                                        <a4j:support event="onclick" 
                                                     oncomplete="if(#{clsDocumentacionSrv.objFirmaDigital.nuEstadoTicket != 1}){javaScript:document.getElementById('frmConversion:btnDetener').click();}">
                                                     
                                        </a4j:support>
                                        
                                    </a4j:commandButton>
                                        
                                    <a4j:commandButton id="btnDescargarPDF" 
                                                       style="display:none;"
                                                       image="/imagenes/descargarPDF.png">
                                                       
                                        <a4j:support event="onclick" action="#{clsDocumentacionSrv.doDecargarPDFcm}"
                                                     onsubmit="#{rich:component('panProcesando')}.show();"
                                                     oncomplete="#{rich:component('panProcesando')}.hide();">
                                        </a4j:support>
                                        
                                    </a4j:commandButton>
                                    
                                    
                                    <h:commandLink id = "cml_conversion_exportarExcel" action="#{clsDocumentacionSrv.doExportarExcel(2)}"
                                               style="margin-right:20px;display:none">
                                        <h:graphicImage url="/imagenes/icoExcel.PNG" style="margin-right:20px;"/>
                                    </h:commandLink>
                                    <a id="link" style="display:none;"
                                           href="${facesContext.externalContext.requestContextPath}/procesarFirma"
                                           target="IFRAMECARGAFIRMA">Modo redireccion a Servlet&nbsp;&nbsp;</a>
                                </h:panelGrid>        
                        </a4j:form>
                        
                    </rich:panel>
                    
                </rich:tab>
                <!-- TAB REPORTES -->
                <rich:tab id="lb_gen_tabReporte" label="#{msgs['lb.gen.tabReporte']}" rendered="true">
                    <rich:panel>
                        <f:facet name="header">
                            <h:outputText id="ot_cer_tabReporte" value="#{msgs['ot.cer.tabReporte']}"/>
                        </f:facet>
                        
                        <a4j:form id="frmReporte" ajaxsubmit="true">
                            <!-- reporte filtros -->
                            <h:panelGrid id="pgReporte_filtro">
                                
                                <h:outputText id="ot_reporte_cer_explicacionFiltro" value="#{msgs['ot.reporte.cer.explicacionFiltro']}"/>
                                <h:panelGrid id="pgReporte_filtro_cer" columns="3" cellpadding="2">
                                
                                    <h:outputText id="ot_reporte_cer_filtro_fechaInicio" value="#{msgs['ot.reporte.cer.filtro.fechaInicio']}"/>
                                    <rich:calendar id="cl_reporte_cer_filtro_fechaInicio" value="#{clsDocumentacionSrv.objFiltroBean.dtFechaInicio}"
                                                   locale="en/ES" datePattern="dd-MM-yyyy"
                                                   cellWidth="12px" cellHeight="22px" inputStyle="width:65px"></rich:calendar>
                                                   
                                    <h:outputText value=""/>
                                    
                                    <h:outputText id="ot_reporte_cer_filtro_fechaFin" value="#{msgs['ot.reporte.cer.filtro.fechaFin']}"/>
                                    <rich:calendar value="#{clsDocumentacionSrv.objFiltroBean.dtFechaFin}"
                                                   id="clFechaFin2" locale="en/ES" datePattern="dd-MM-yyyy"
                                                   cellWidth="12px" cellHeight="22px" inputStyle="width:65px"></rich:calendar>
                                    
                                    <a4j:commandButton id="bt_reporte_cer_filtro_buscar" 
                                                       value="#{msgs['bt.reporte.cer.filtro.buscar']}">
                                                       
                                        <a4j:support event="onclick" 
                                                     action="#{clsDocumentacionSrv.doListarReporte(3)}"
                                                     reRender="dtb_reporte_cer_resultados,bt_reporte_cer_accion_exportarExcel_superior,bt_reporte_cer_accion_exportarExcel_inferior"
                                                     onsubmit="#{rich:component('panProcesando')}.show();"
                                                     oncomplete="#{rich:component('panProcesando')}.hide();">
                                        </a4j:support>                 
                                        
                                    </a4j:commandButton>
                                    
                                </h:panelGrid>
                            </h:panelGrid>
                            <hr/>
                            <!-- reporte acciones superior -->
                            <h:panelGrid id="pgReporte_acciones_cer_superior">
                                <!--Exporta exel-->
                                <a4j:commandButton id="bt_reporte_cer_accion_exportarExcel_superior" 
                                                   value="#{msgs['bt.generacion.cer.accion.exportarExcel']}"
                                                   style="display:#{clsDocumentacionSrv.vcMuestraExelReporte}">
                                        <a4j:support event="onclick"
                                                    onsubmit="#{rich:component('panProcesando')}.show();"
                                                    onclick = "javaScript:document.getElementById('frmReporte:cml_reporte_exportarExcel').click();"
                                                    oncomplete="#{rich:component('panProcesando')}.hide();"
                                                    >
                                        </a4j:support>
                                </a4j:commandButton> 
                                
                                <!--Exporta exel--> 
                                
                                
                            </h:panelGrid>
                      
                            <!-- reporte acciones inferior -->
                            <h:panelGrid id="pgReporte_acciones_cer_inferior">
                                <!--Exporta exel-->
                                <a4j:commandButton id="bt_reporte_cer_accion_exportarExcel_inferior" 
                                                   value="#{msgs['bt.generacion.cer.accion.exportarExcel']}"
                                                   style="display:#{clsDocumentacionSrv.vcMuestraExelReporte}">
                                        <a4j:support event="onclick"
                                                    onsubmit="#{rich:component('panProcesando')}.show();"
                                                    onclick = "javaScript:document.getElementById('frmReporte:cml_reporte_exportarExcel').click();"
                                                    oncomplete="#{rich:component('panProcesando')}.hide();"
                                                    >
                                        </a4j:support>
                                </a4j:commandButton> 
                                
                                <!--Exporta exel-->
                            </h:panelGrid>
                            <hr/>
                            <!-- reporte acciones general -->
                            <h:panelGrid id="pgReporte_acciones_general">
                                <h:commandLink id = "cml_reporte_exportarExcel" action="#{clsDocumentacionSrv.doExportarExcel(3)}"
                                               style="margin-right:20px;display:none">
                                        <h:graphicImage url="/imagenes/icoExcel.PNG" style="margin-right:20px;"/>
                                </h:commandLink>
                            </h:panelGrid>
                        </a4j:form>
                        
                    </rich:panel>
                    
                </rich:tab>
         
            </rich:tabPanel>
            
            <iframe src="" id="IFRAMECARGAFIRMA" name="IFRAMECARGAFIRMA" style="display:none;"></iframe>
            
        </rich:panel>
         
         <rich:modalPanel id="panProcesando" autosized="true" width="300">
            
            <center>
                
                <h:outputText value="Espere por favor..."/>
                <br></br>
               
                <center>
               <div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
                <!--h:graphicImage value="imagenes/loading.gif"/-->
                </center>
            </center>
            
        </rich:modalPanel>  
         
        <rich:modalPanel id="panCargaDocumentos" autosized="true" styleClass="modal-form">
            
            <f:facet name="header">
                <h:outputText value="Cargar Documentos"></h:outputText>
            </f:facet>
            
            <a4j:form id="formCargaArchivo" ajaxSubmit="true">
            
                <h:outputLabel value="Por favor tenga en cuenta lo siguiente: \\n
                                -El nombre de los archivos debe tener el siguiente formato (Expediente)NNNNNN-YYYY-TYPE.doc \\n
                                -Solo se admiten archivos en formato DOC."/>
                
                <rich:fileUpload id="fileAdjuntaDocumento"
                                 fileUploadListener="#{clsDocumentacionSrv.listenerDocumentos}"
                                 allowFlash="false"
                                 immediateUpload="false"
                                 acceptedTypes="doc" 
                                 maxFilesQuantity="50"
                                 addControlLabel="Subir archivo..."
                                 clearAllControlLabel="Eliminar"
                                 clearControlLabel="Eliminar"
                                 stopEntryControlLabel="Detener"
                                 uploadControlLabel="Subir archivo"
                                 doneLabel="Terminado" 
                                 listWidth="500px"
                                 listHeight="150px" 
                                 autoclear="false"
                                 alt="Se permiten la extension pdf">
                           
                    <f:facet name="label">
                      <h:outputText value="{_KB}KB de {KB}KB cargados --- {mm}:{ss}"/>
                    </f:facet>
                    
                    <a4j:support event="onuploadcomplete"
                                 oncomplete="javaScript:Richfaces.hideModalPanel('panCargaDocumentos');"
                                 reRender="dtb_conversion_not_resultados,dtb_conversion_cer_resultados">
                    </a4j:support>
                            
                    <a4j:support event="onclear" 
                                 reRender="fileAdjuntaDocumento">
                    </a4j:support>
                    
                </rich:fileUpload>
                
                <br/>
                
                <center>
                
                    <a4j:commandButton id="btnCancelarCargaArchivo" value="Cancelar">
                        <a4j:support event="onclick" oncomplete="javaScript:Richfaces.hideModalPanel('panCargaDocumentos');"></a4j:support>
                    </a4j:commandButton>
                    
                </center>
                
            </a4j:form>
            
        </rich:modalPanel>
        
    </body>
</html>
